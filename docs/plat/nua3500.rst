NUVOTON NUA3500 
=================

Trusted Firmware-A supports Nuvoton ARM SoC AARCH64 fields.
nua3500: dual-core Cortex-A35


Memory mapping
~~~~~~~~~~~~~~

::

    0x00000000 +-----------------+
               |                 |
    0x20000000 +-----------------+
               |                 |
    0x24000000 +-----------------+ \
               |                 | |
               |                 | |
    0x28000000 +-----------------+ |
               |       BL2       | | Embedded SRAM
    0x28010000 +-----------------+ |
               |       BL31      | |
    0x30000000 +-----------------+ /
               |                 |
               |                 |
    0x40000000 +-----------------+
               |                 |
               |                 |   Peripheral
               |                 |
    0x50000000 +-----------------+ 
               |                 | 
               |                 |   BootRom, GIC
               |                 | 
    0x60000000 +-----------------+
               |                 |
               |                 |
    0x80000000 +-----------------+ \
               |                 | |
               |       BL33      | | Non-secure RAM (DDR)
               |       ...       | |
               |                 | |
    0x8F800000 +-----------------+ /\
               |                 |  |
               |       BL32      |  | Secure RAM (DDR)
    0x8FFFFFFF +-----------------+  /


Boot Sequence
-------------

Bootrom -> BL2 (compiled with BL2_AT_EL3) -> BL31 -> OP-TEE -> BL31 --> BL33(u-boot)

How to build
------------

Build Procedure
~~~~~~~~~~~~~~~

-  Prepare AARCH64 toolchain.

-  Build optee (BL32) and u-boot (BL33) firstly, and get binary images: tee-pager_v2.bin and u-boot.bin

-  Build TF-A

   Build bl2 and bl31:

   .. code:: shell

       CROSS_COMPILE=aarch64-linux-gnu- make PLAT=nua3500  (bl2, bl31, DTB)

       CROSS_COMPILE=aarch64-linux-gnu- make PLAT=nua3500 fiptool

	./tools/fiptool/fiptool create \
		--soc-fw build/nua3500/release/bl31.bin \
		--tos-fw fiptool_images/tee-header_v2.bin \
		--tos-fw-extra1 fiptool_images/tee-pager_v2.bin \
		--nt-fw fiptool_images/u-boot.bin \
		fip.bin



How to deploy
-------------

Both upstream U-Boot and OPTEE projects contain instructions on where
to put the built images during their respective build process.
So after successfully building TF-A just follow their build instructions
to continue.
